<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kara C. Hoover, Mark J. Hudson, and Mauricio Hernandez">
<meta name="dcterms.date" content="2025-02-11">

<title>Resilience and Health in Colonial Ryukyu Islands</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="ryukyu-project-summary_files/libs/clipboard/clipboard.min.js"></script>
<script src="ryukyu-project-summary_files/libs/quarto-html/quarto.js"></script>
<script src="ryukyu-project-summary_files/libs/quarto-html/popper.min.js"></script>
<script src="ryukyu-project-summary_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ryukyu-project-summary_files/libs/quarto-html/anchor.min.js"></script>
<link href="ryukyu-project-summary_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ryukyu-project-summary_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ryukyu-project-summary_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ryukyu-project-summary_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ryukyu-project-summary_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Resilience and Health in Colonial Ryukyu Islands</h1>
<p class="subtitle lead">Bioarchaeological analysis of skeletal health markers across early modern Okinawa</p>
  <div class="quarto-categories">
    <div class="quarto-category">bioarchaeology</div>
    <div class="quarto-category">colonialism</div>
    <div class="quarto-category">health disparity</div>
    <div class="quarto-category">Okinawa</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kara C. Hoover, Mark J. Hudson, and Mauricio Hernandez </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 11, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This project examines how Japanese colonial control (1609-1879) affected health and resilience across the Ryukyu Islands (modern-day Okinawa). Using skeletal remains from three archaeological sites, we investigate whether distance from political centers influenced health outcomes and whether men and women experienced colonialism differently.</p>
<p><strong>Key Finding:</strong> Remote communities showed different health patterns than the port city, suggesting distance from colonial control may have provided some protection through retained cultural autonomy.</p>
</section>
<section id="research-questions" class="level2">
<h2 class="anchored" data-anchor-id="research-questions">Research Questions</h2>
<ol type="1">
<li>Did health decline after Satsuma domain assumed control in 1609?</li>
<li>Were there geographic differences in health across the islands?</li>
<li>Did men and women experience different health outcomes?</li>
<li>Can health differences be linked to sociopolitical autonomy and resilience?</li>
</ol>
</section>
<section id="what-we-found" class="level2">
<h2 class="anchored" data-anchor-id="what-we-found">What We Found</h2>
<section id="dental-attrition-diet-quality" class="level3">
<h3 class="anchored" data-anchor-id="dental-attrition-diet-quality">Dental Attrition (Diet Quality)</h3>
<ul>
<li><strong>Nagabaka (remote):</strong> 2x higher wear than Yatchi port city (p&lt;0.001)</li>
<li><strong>Kanna (northern):</strong> 1.6x higher wear than Yatchi (p=0.010)</li>
<li><strong>Nagabaka males:</strong> Showed additional elevation (p=0.022)</li>
<li><strong>Interpretation:</strong> Remote areas had coarser diets, possibly indicating limited access to trade goods</li>
</ul>
</section>
<section id="cribra-orbitalia-anemiairon-deficiency" class="level3">
<h3 class="anchored" data-anchor-id="cribra-orbitalia-anemiairon-deficiency">Cribra Orbitalia (Anemia/Iron Deficiency)</h3>
<ul>
<li><strong>Yatchi (port city):</strong> Highest prevalence</li>
<li><strong>Kanna:</strong> Significantly lower than Yatchi (p=0.006)</li>
<li><strong>Pattern:</strong> Port city paradox - economic activity but poor health</li>
</ul>
</section>
<section id="dental-calculus-dietary-carbohydrates" class="level3">
<h3 class="anchored" data-anchor-id="dental-calculus-dietary-carbohydrates">Dental Calculus (Dietary Carbohydrates)</h3>
<ul>
<li><strong>Nagabaka:</strong> Lowest levels (approaching significance, p=0.055)</li>
<li><strong>Consistent pattern:</strong> Women had lower calculus than men across all sites</li>
</ul>
</section>
<section id="enamel-hypoplasia-childhood-stress" class="level3">
<h3 class="anchored" data-anchor-id="enamel-hypoplasia-childhood-stress">Enamel Hypoplasia (Childhood Stress)</h3>
<ul>
<li><strong>No significant differences</strong> across sites or sexes</li>
<li><strong>Interpretation:</strong> Everyone faced similar early-life challenges regardless of location</li>
</ul>
</section>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<p><strong>Dental Sample:</strong> 136 individuals from three burial sites (17th-19th centuries)</p>
<ul>
<li>Kanna Weenu Atai (n=32): Remote northern cave site</li>
<li>Paimmi-nu-Nagabaka (n=45): Distant Miyako Island</li>
<li>Yatchi-no-Gama (n=48): Port city on trade route</li>
</ul>
<p><strong>Skull Sample:</strong> 253 individuals from three burial sites (17th-19th centuries)</p>
<ul>
<li>Kanna Weenu Atai (n=88): Remote northern cave site</li>
<li>Paimmi-nu-Nagabaka (n=96): Distant Miyako Island</li>
<li>Yatchi-no-Gama (n=69): Port city on trade route</li>
</ul>
<p><strong>Analysis:</strong> Generalized Linear Models (GLM)</p>
<ul>
<li>Gaussian family: hypoplasia, calculus</li>
<li>Gamma family: dental attrition (better fit for skewed data)</li>
<li>Binomial family: cribra orbitalia (presence/absence)</li>
</ul>
<p><strong>Predictors:</strong> Site, sex, site×sex interaction</p>
</section>
<section id="model-results" class="level2">
<h2 class="anchored" data-anchor-id="model-results">Model Results</h2>
<p>During the exploratory analysis, we determined that the data were not normally distributed, which indicated the use of GLM. In the models, we used the Gaussian family for hypoplasia and calculus data and the Gamma family for attrition data due to the right-skew in the distribution.</p>
<div class="cell">
<div id="tbl-results" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: GLM Model Results
</figcaption>
<div aria-describedby="tbl-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 22%">
<col style="width: 11%">
<col style="width: 7%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">SE</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">95% CI Low</th>
<th style="text-align: right;">95% CI High</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Hypoplasia</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.189</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">0.308</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hypoplasia</td>
<td style="text-align: left;">siteKanna</td>
<td style="text-align: right;">-0.123</td>
<td style="text-align: right;">0.091</td>
<td style="text-align: right;">0.180</td>
<td style="text-align: right;">-0.301</td>
<td style="text-align: right;">0.056</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hypoplasia</td>
<td style="text-align: left;">siteNagabaka</td>
<td style="text-align: right;">-0.014</td>
<td style="text-align: right;">0.087</td>
<td style="text-align: right;">0.874</td>
<td style="text-align: right;">-0.185</td>
<td style="text-align: right;">0.158</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hypoplasia</td>
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">0.130</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">0.135</td>
<td style="text-align: right;">-0.039</td>
<td style="text-align: right;">0.300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hypoplasia</td>
<td style="text-align: left;">siteKanna:sexM</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">0.128</td>
<td style="text-align: right;">0.592</td>
<td style="text-align: right;">-0.182</td>
<td style="text-align: right;">0.319</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hypoplasia</td>
<td style="text-align: left;">siteNagabaka:sexM</td>
<td style="text-align: right;">-0.153</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.224</td>
<td style="text-align: right;">-0.398</td>
<td style="text-align: right;">0.092</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Calculus</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.390</td>
<td style="text-align: right;">0.117</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.161</td>
<td style="text-align: right;">0.619</td>
</tr>
<tr class="even">
<td style="text-align: left;">Calculus</td>
<td style="text-align: left;">siteKanna</td>
<td style="text-align: right;">0.011</td>
<td style="text-align: right;">0.158</td>
<td style="text-align: right;">0.942</td>
<td style="text-align: right;">-0.299</td>
<td style="text-align: right;">0.322</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Calculus</td>
<td style="text-align: left;">siteNagabaka</td>
<td style="text-align: right;">-0.297</td>
<td style="text-align: right;">0.153</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">-0.598</td>
<td style="text-align: right;">0.003</td>
</tr>
<tr class="even">
<td style="text-align: left;">Calculus</td>
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.183</td>
<td style="text-align: right;">0.387</td>
<td style="text-align: right;">-0.200</td>
<td style="text-align: right;">0.517</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Calculus</td>
<td style="text-align: left;">siteKanna:sexM</td>
<td style="text-align: right;">-0.098</td>
<td style="text-align: right;">0.234</td>
<td style="text-align: right;">0.676</td>
<td style="text-align: right;">-0.557</td>
<td style="text-align: right;">0.361</td>
</tr>
<tr class="even">
<td style="text-align: left;">Calculus</td>
<td style="text-align: left;">siteNagabaka:sexM</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.228</td>
<td style="text-align: right;">0.951</td>
<td style="text-align: right;">-0.433</td>
<td style="text-align: right;">0.461</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Attrition GAMMA</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">1.941</td>
<td style="text-align: right;">0.119</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.717</td>
<td style="text-align: right;">2.184</td>
</tr>
<tr class="even">
<td style="text-align: left;">Attrition GAMMA</td>
<td style="text-align: left;">siteKanna</td>
<td style="text-align: right;">0.473</td>
<td style="text-align: right;">0.181</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.120</td>
<td style="text-align: right;">0.832</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Attrition GAMMA</td>
<td style="text-align: left;">siteNagabaka</td>
<td style="text-align: right;">0.722</td>
<td style="text-align: right;">0.174</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.381</td>
<td style="text-align: right;">1.065</td>
</tr>
<tr class="even">
<td style="text-align: left;">Attrition GAMMA</td>
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">-0.240</td>
<td style="text-align: right;">0.170</td>
<td style="text-align: right;">0.161</td>
<td style="text-align: right;">-0.574</td>
<td style="text-align: right;">0.095</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Attrition GAMMA</td>
<td style="text-align: left;">siteKanna:sexM</td>
<td style="text-align: right;">0.285</td>
<td style="text-align: right;">0.256</td>
<td style="text-align: right;">0.268</td>
<td style="text-align: right;">-0.218</td>
<td style="text-align: right;">0.786</td>
</tr>
<tr class="even">
<td style="text-align: left;">Attrition GAMMA</td>
<td style="text-align: left;">siteNagabaka:sexM</td>
<td style="text-align: right;">0.562</td>
<td style="text-align: right;">0.242</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">0.086</td>
<td style="text-align: right;">1.037</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cribra Orbitalia</td>
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.427</td>
<td style="text-align: right;">0.332</td>
<td style="text-align: right;">0.198</td>
<td style="text-align: right;">-0.214</td>
<td style="text-align: right;">1.099</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cribra Orbitalia</td>
<td style="text-align: left;">siteKanna</td>
<td style="text-align: right;">-1.408</td>
<td style="text-align: right;">0.513</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">-2.452</td>
<td style="text-align: right;">-0.429</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cribra Orbitalia</td>
<td style="text-align: left;">siteNagabaka</td>
<td style="text-align: right;">-0.502</td>
<td style="text-align: right;">0.508</td>
<td style="text-align: right;">0.324</td>
<td style="text-align: right;">-1.512</td>
<td style="text-align: right;">0.492</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cribra Orbitalia</td>
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">0.805</td>
<td style="text-align: right;">0.543</td>
<td style="text-align: right;">0.138</td>
<td style="text-align: right;">-0.234</td>
<td style="text-align: right;">1.916</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cribra Orbitalia</td>
<td style="text-align: left;">siteKanna:sexM</td>
<td style="text-align: right;">-0.301</td>
<td style="text-align: right;">0.733</td>
<td style="text-align: right;">0.682</td>
<td style="text-align: right;">-1.755</td>
<td style="text-align: right;">1.135</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cribra Orbitalia</td>
<td style="text-align: left;">siteNagabaka:sexM</td>
<td style="text-align: right;">-1.216</td>
<td style="text-align: right;">0.738</td>
<td style="text-align: right;">0.099</td>
<td style="text-align: right;">-2.690</td>
<td style="text-align: right;">0.215</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="marginal-effects" class="level2">
<h2 class="anchored" data-anchor-id="marginal-effects">Marginal Effects</h2>
<p>Figure 1 displays the marginal effects (predicted values) from the GLM models, showing predicted values with 95% confidence intervals for each health marker by site and sex. The visualization highlights the significant site differences detected in attrition (panel C) and cribra orbitalia (panel D), while also revealing consistent sex-based patterns in calculus (panel B) where women showed lower values across all sites. The patterns reveal that remote sites (Nagabaka, Kanna) showed elevated attrition but lower cribra orbitalia prevalence compared to the port city Yatchi, suggesting distinct health profiles related to distance from colonial centers.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="fig3-marginal-effects.png" class="img-fluid figure-img"></p>
<figcaption><strong>Figure 1. Marginal effects (predicted values) by site and sex.</strong></figcaption>
</figure>
</div>
</section>
<section id="key-insights" class="level2">
<h2 class="anchored" data-anchor-id="key-insights">Key Insights</h2>
<p><strong>Distance Matters</strong> Despite being far from economic centers, remote sites (Nagabaka, Kanna) showed lower anemia rates. This suggests that remote sites:</p>
<ul>
<li>Retained food security through traditional subsistence</li>
<li>Were less exposure to diseases from trade routes</li>
<li>Had greater cultural autonomy from colonial demands</li>
</ul>
<p><strong>Gender Matters</strong> The significant sex by site interaction at Nagabaka suggests:</p>
<ul>
<li>Gender-based economic specialization under taxation</li>
<li>Men paid grain tax (agricultural work → high dental wear)</li>
<li>Women paid cloth tax (weaving → craft specialization)</li>
</ul>
<p><strong>Colonial Control Created Health Disparities</strong> Yatchi’s pattern (high anemia, low dental wear) fits a “goods everywhere but none for locals” scenario indicating that economic activity didn’t benefit resident health.</p>
</section>
<section id="significance" class="level2">
<h2 class="anchored" data-anchor-id="significance">Significance</h2>
<p>This research demonstrates that:</p>
<ol type="1">
<li><strong>Colonial impacts varied by geography</strong> - not uniformly negative</li>
<li><strong>Distance from power centers</strong> could enhance resilience in some contexts</li>
<li><strong>Traditional food systems</strong> may have buffered health impacts</li>
<li><strong>Gender-based labor systems</strong> created sex-specific health outcomes</li>
</ol>
<p>These findings contribute to understanding:</p>
<ul>
<li>How colonialism affects peripheral populations</li>
<li>The role of cultural autonomy in community resilience</li>
<li>How skeletal bioarchaeology extends historical analysis</li>
</ul>
</section>
<section id="data-code" class="level2">
<h2 class="anchored" data-anchor-id="data-code">Data &amp; Code</h2>
<p><strong>Repository:</strong> <a href="https://github.com/kchoover14/RyukyuResilience">github.com/kchoover14/RyukyuResilience</a></p>
<p><strong>Available:</strong></p>
<ul>
<li>Raw data (Excel format)</li>
<li>Cleaned data (CSV format)</li>
<li>R scripts for data cleaning, exploration, and analysis</li>
<li>Figures and diagnostic plots</li>
<li>Model results (coefficients, diagnostics)</li>
</ul>
<p><strong>Reproducible workflow:</strong></p>
<ol type="1">
<li><code>script1-cleaning.R</code> - Import from Excel</li>
<li><code>script2-exploration.R</code> - Descriptive statistics and QQ plots</li>
<li><code>script3-analysis.R</code> - GLM models and marginal effects</li>
</ol>
</section>
<section id="tools-technologies" class="level2">
<h2 class="anchored" data-anchor-id="tools-technologies">Tools &amp; Technologies</h2>
<ul>
<li><strong>R 4.5.2</strong> for statistical analysis</li>
<li><strong>Packages:</strong> readxl, dplyr, janitor, ggplot2, skimr, ggeffects, cowplot, broom</li>
<li><strong>Models:</strong> GLM with Gaussian, Gamma, and Binomial families</li>
<li><strong>Visualization:</strong> ggplot2 for publication-quality figures</li>
</ul>
</section>
<section id="publication-status" class="level2">
<h2 class="anchored" data-anchor-id="publication-status">Publication Status</h2>
<p><strong>Manuscript:</strong> In preparation for submission</p>
<p><strong>Collaborators:</strong> - Mark J. Hudson (Max Planck Institute) - Mauricio Hernandez (University of Florida) - Kara C. Hoover (University of Alaska Fairbanks)</p>
</section>
<section id="related-work" class="level2">
<h2 class="anchored" data-anchor-id="related-work">Related Work</h2>
<p>This project is part of broader research on bioarchaeology: - colonialism and health disparities - Resilience in socio-ecological systems</p>
</section>
<section id="learn-more" class="level2">
<h2 class="anchored" data-anchor-id="learn-more">Learn More</h2>
<p><strong>Read the paper:</strong> [Link to be added upon publication]</p>
<p><strong>Explore the data:</strong> <a href="https://github.com/kchoover14/RyukyuResilience">GitHub Repository</a></p>
<p><strong>Questions?</strong> Contact: kchoover@proton.me</p>
<hr>
<p><em>This project demonstrates how bioarchaeological methods can illuminate the health impacts of historical colonialism and the role of geographic and cultural factors in community resilience.</em></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>